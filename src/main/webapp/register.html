<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Log in</title>
    <script src="https://kit.fontawesome.com/7a198ceb62.js"></script>
	<link rel = "stylesheet" href = "register.css">
</head>
<body>
	<div id="register-box">
		<h1>Register</h1>
		<div class = "form">
			<div class = "item">
			<i class="fas fa-user"></i>
			<input id = "username" type = "text" placeholder="Username">
			</div>
			
			<div class = "item">
			<i class="fas fa-unlock-alt"></i>
			<input id = "password" type = "text" placeholder="Password">
			</div>

		</div>
		<a href = ""> 
		    <button onclick="register">Submit</button>
		</a>
	</div>
	<script>
	
	    var restServlet = "http://localhost:8080/CentroGeo/UserResource/users";
	    let userName = document.getElementById("username");
	    let userPassword = document.getElementById("password");
     
	    function register() {
	    	
    	var	xmlhttp = new XMLHttpRequest();
    	xmlhttp.onreadystatechange = function() {
    	    if (this.readyState == 4 && this.status == 204) {
    	    	
            	xmlhttp.onreadystatechange = function() {
            	    if (this.readyState == 4 && this.status == 200) {
        		    	
            	    	let xmlDoc = this.responseXML;
        		    	result = xmlDoc.getElementByTag("result");
        		    	if(result == "success"){
           	           		 document.getElementByTag("a").href = "log_in.html";
           	           		 console.log("register successfully! You can log in now.");
        		        }
        		        else{
        		    	   console.log("user already exists, please log in directly");
        		       }
    	            }
                 }    
             }
    	}	    
    	     xmlhttp.open("POST", restServlet, true);
    	     xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    		 xmlhttp.send("name="+userName+"&"+"password="+userPassword);
	 };
	</script>

</body>
</html>